const a7_0x5dc7d1=a7_0x3a4c;(function(_0x10195f,_0x46fd35){const _0x4e3b92=a7_0x3a4c,_0x1d8cb3=_0x10195f();while(!![]){try{const _0x389b76=-parseInt(_0x4e3b92(0x126))/0x1+parseInt(_0x4e3b92(0x10c))/0x2+parseInt(_0x4e3b92(0x127))/0x3*(parseInt(_0x4e3b92(0xe2))/0x4)+parseInt(_0x4e3b92(0x106))/0x5*(-parseInt(_0x4e3b92(0x110))/0x6)+parseInt(_0x4e3b92(0x101))/0x7+-parseInt(_0x4e3b92(0x12c))/0x8*(-parseInt(_0x4e3b92(0x109))/0x9)+-parseInt(_0x4e3b92(0xed))/0xa*(parseInt(_0x4e3b92(0xde))/0xb);if(_0x389b76===_0x46fd35)break;else _0x1d8cb3['push'](_0x1d8cb3['shift']());}catch(_0x8b76de){_0x1d8cb3['push'](_0x1d8cb3['shift']());}}}(a7_0x10bc,0xd0c94));function a7_0x10bc(){const _0x272a6e=['Router','next','__esModule','regal_secret_key','status','../models/User','resetKey','findOne','password','delete','apply','noreply@things-connect.net','3542924bCKBNP','Login\x20successful','hex','value','../models/Product','2013860iQbyJb','crypto','/forgot-password','45rZDvZu','save','Internal\x20server\x20error','898746lMoNQp','then','.\x20It\x20is\x20valid\x20for\x2010\x20minutes.','toUpperCase','12pnZmwB','Your\x20password\x20reset\x20key\x20is:\x20','default','_id','__awaiter','Forgot\x20Password\x20Error:','/register','Delete\x20products\x20related','sign','toString','Delete\x20companies\x20related','env','Delete\x20Account\x20Error:','Invalid\x20email\x20or\x20password','Missing\x20required\x20fields','../middlewares/authorise','Account\x20deleted\x20successfully','search','NO_REPLY_MAIL','userID','User\x20with\x20this\x20email\x20does\x20not\x20exist','randomBytes','567948aPgGJY','3RTuHyl','JWT_SECRET','deleteMany','express','sendMail','486608HXmXLr','User\x20already\x20exists','11aoowem','password\x20reset\x20success!','json','NO_REPLY_MAIL_PASS','5429036fMBrEq','reset!','(((.+)+)+)+$','post','User\x20not\x20found','throw','hash','error','We8Z','compare','../models/Company','3882140omHVoL','/login','bcrypt','done','Product','log','body','User'];a7_0x10bc=function(){return _0x272a6e;};return a7_0x10bc();}function a7_0x3a4c(_0x7b43d3,_0x43d5d7){const _0x1ef46d=a7_0x10bc();return a7_0x3a4c=function(_0x2f1869,_0x4bf7e2){_0x2f1869=_0x2f1869-0xdd;let _0x10bcdd=_0x1ef46d[_0x2f1869];return _0x10bcdd;},a7_0x3a4c(_0x7b43d3,_0x43d5d7);}const a7_0x4bf7e2=(function(){let _0x38c118=!![];return function(_0x30c0d6,_0x3fea7d){const _0x914ed=_0x38c118?function(){const _0x4fcf1e=a7_0x3a4c;if(_0x3fea7d){const _0x4c0fc8=_0x3fea7d[_0x4fcf1e(0xff)](_0x30c0d6,arguments);return _0x3fea7d=null,_0x4c0fc8;}}:function(){};return _0x38c118=![],_0x914ed;};}()),a7_0x2f1869=a7_0x4bf7e2(this,function(){const _0x48880b=a7_0x3a4c;return a7_0x2f1869[_0x48880b(0x119)]()[_0x48880b(0x121)](_0x48880b(0xe4))[_0x48880b(0x119)]()['constructor'](a7_0x2f1869)[_0x48880b(0x121)]('(((.+)+)+)+$');});a7_0x2f1869();'use strict';var __awaiter=this&&this[a7_0x5dc7d1(0x114)]||function(_0x3e75b9,_0x5d8c03,_0x471770,_0x5e7702){function _0x241f8b(_0x1ced88){return _0x1ced88 instanceof _0x471770?_0x1ced88:new _0x471770(function(_0x24d512){_0x24d512(_0x1ced88);});}return new(_0x471770||(_0x471770=Promise))(function(_0x3308ba,_0x46303e){const _0x38e36b=a7_0x3a4c;function _0x3f46d7(_0x106df6){const _0xa6733e=a7_0x3a4c;try{_0x18daaf(_0x5e7702[_0xa6733e(0xf6)](_0x106df6));}catch(_0x272968){_0x46303e(_0x272968);}}function _0x379c37(_0x4317c9){const _0x555b21=a7_0x3a4c;try{_0x18daaf(_0x5e7702[_0x555b21(0xe7)](_0x4317c9));}catch(_0x5a398a){_0x46303e(_0x5a398a);}}function _0x18daaf(_0x2b9977){const _0x794b6d=a7_0x3a4c;_0x2b9977[_0x794b6d(0xf0)]?_0x3308ba(_0x2b9977[_0x794b6d(0x104)]):_0x241f8b(_0x2b9977[_0x794b6d(0x104)])[_0x794b6d(0x10d)](_0x3f46d7,_0x379c37);}_0x18daaf((_0x5e7702=_0x5e7702[_0x38e36b(0xff)](_0x3e75b9,_0x5d8c03||[]))[_0x38e36b(0xf6)]());});},__importDefault=this&&this['__importDefault']||function(_0x1d67bb){const _0x242d41=a7_0x5dc7d1;return _0x1d67bb&&_0x1d67bb[_0x242d41(0xf7)]?_0x1d67bb:{'default':_0x1d67bb};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const express_1=__importDefault(require(a7_0x5dc7d1(0x12a))),bcrypt_1=__importDefault(require(a7_0x5dc7d1(0xef))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),nodemailer_1=__importDefault(require('nodemailer')),crypto_1=__importDefault(require(a7_0x5dc7d1(0x107))),User_1=require(a7_0x5dc7d1(0xfa)),authorise_1=__importDefault(require(a7_0x5dc7d1(0x11f))),Product_1=require(a7_0x5dc7d1(0x105)),Company_1=require(a7_0x5dc7d1(0xec)),router=express_1[a7_0x5dc7d1(0x112)][a7_0x5dc7d1(0xf5)]();router['post'](a7_0x5dc7d1(0x116),(_0x353606,_0x93c02c)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3388a5=a7_0x5dc7d1;try{const {firstName:_0x132611,lastName:_0x56ed69,email:_0x115ad5,password:_0x367180,phone:_0x3cf7f8,age:_0x15e13c,address:_0x138d14}=_0x353606[_0x3388a5(0xf3)];if(!_0x132611||!_0x56ed69||!_0x115ad5||!_0x367180){_0x93c02c[_0x3388a5(0xf9)](0x190)[_0x3388a5(0xe0)]({'message':_0x3388a5(0x11e)});return;}const _0x352a77=yield User_1[_0x3388a5(0xf4)][_0x3388a5(0xfc)]({'email':_0x115ad5});if(_0x352a77){_0x93c02c[_0x3388a5(0xf9)](0x190)['json']({'message':_0x3388a5(0xdd)});return;}const _0x3cfda0=0xa,_0x3522b4=yield bcrypt_1[_0x3388a5(0x112)][_0x3388a5(0xe8)](_0x367180,_0x3cfda0),_0x50053b=new User_1[(_0x3388a5(0xf4))]({'firstName':_0x132611,'lastName':_0x56ed69,'email':_0x115ad5,'password':_0x3522b4,'phone':_0x3cf7f8,'age':_0x15e13c,'address':_0x138d14});yield _0x50053b['save'](),_0x93c02c['status'](0xc8)[_0x3388a5(0xe0)]({'message':'User\x20registered\x20successfully','user':_0x50053b});}catch(_0x35ae0c){_0x93c02c[_0x3388a5(0xf9)](0x1f4)['json']({'message':'Internal\x20server\x20error','error':_0x35ae0c});}})),router[a7_0x5dc7d1(0xe5)](a7_0x5dc7d1(0xee),(_0x28f077,_0x55ced1)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4e8025=a7_0x5dc7d1;try{const {email:_0x10ad18,password:_0x55d252}=_0x28f077[_0x4e8025(0xf3)],_0xe02b31=yield User_1[_0x4e8025(0xf4)]['findOne']({'email':_0x10ad18});if(!_0xe02b31){_0x55ced1[_0x4e8025(0xf9)](0x191)['json']({'message':_0x4e8025(0x11d)});return;}const _0x11fbed=yield bcrypt_1[_0x4e8025(0x112)][_0x4e8025(0xeb)](_0x55d252,_0xe02b31[_0x4e8025(0xfd)]);if(!_0x11fbed){_0x55ced1[_0x4e8025(0xf9)](0x191)[_0x4e8025(0xe0)]({'message':_0x4e8025(0x11d)});return;}const _0x4baa57=jsonwebtoken_1['default'][_0x4e8025(0x118)]({'_id':_0xe02b31[_0x4e8025(0x113)],'email':_0xe02b31['email']},process[_0x4e8025(0x11b)][_0x4e8025(0x128)]||_0x4e8025(0xf8),{'expiresIn':'1h'});_0x55ced1[_0x4e8025(0xf9)](0xc8)[_0x4e8025(0xe0)]({'message':_0x4e8025(0x102),'user':_0xe02b31,'token':_0x4baa57});}catch(_0x49d5fe){_0x55ced1[_0x4e8025(0xf9)](0x1f4)[_0x4e8025(0xe0)]({'message':_0x4e8025(0x10b),'error':_0x49d5fe});}})),router[a7_0x5dc7d1(0xe5)](a7_0x5dc7d1(0x108),(_0x19a3d8,_0x5040a0)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x562fef=a7_0x5dc7d1;try{const {email:_0x4aeba9}=_0x19a3d8[_0x562fef(0xf3)],_0x11207e=yield User_1[_0x562fef(0xf4)][_0x562fef(0xfc)]({'email':_0x4aeba9});if(!_0x11207e){_0x5040a0[_0x562fef(0xf9)](0x194)[_0x562fef(0xe0)]({'message':_0x562fef(0x124)});return;}const _0x3448f7=crypto_1[_0x562fef(0x112)][_0x562fef(0x125)](0x4)[_0x562fef(0x119)](_0x562fef(0x103))[_0x562fef(0x10f)]();_0x11207e[_0x562fef(0xfb)]=_0x3448f7,yield _0x11207e[_0x562fef(0x10a)]();const _0x5067e2=nodemailer_1['default']['createTransport']({'service':'gmail','auth':{'user':process[_0x562fef(0x11b)][_0x562fef(0x122)],'pass':process[_0x562fef(0x11b)][_0x562fef(0xe1)]}}),_0x147583={'from':_0x562fef(0x100),'to':_0x4aeba9,'subject':'RESET\x20PASSWORD','text':_0x562fef(0x111)+_0x3448f7+_0x562fef(0x10e)};_0x5067e2[_0x562fef(0x12b)](_0x147583,function(_0x7c92ce,_0x28c7bb){const _0x3a2c33=_0x562fef;if(_0x7c92ce)console['log'](_0x7c92ce),_0x5040a0['status'](0x194)['json']({'status':0x0,'message':'failure','error':_0x7c92ce});else{_0x5040a0[_0x3a2c33(0xf9)](0xc8)[_0x3a2c33(0xe0)]({'status':0x0,'message':_0x3a2c33(0xdf)});let _0x389cc5=0x927c0;new Promise(function(_0x55bd39,_0xafd68d){setTimeout(()=>{const _0x5a6d44=a7_0x3a4c;console[_0x5a6d44(0xf2)](_0x5a6d44(0xe3)),_0x11207e['resetKey']=_0x5a6d44(0xea),_0x11207e[_0x5a6d44(0x10a)]();},_0x389cc5);});}});}catch(_0x27476f){console[_0x562fef(0xe9)](_0x562fef(0x115),_0x27476f),_0x5040a0['status'](0x1f4)[_0x562fef(0xe0)]({'message':'Internal\x20server\x20error','error':_0x27476f});}})),router[a7_0x5dc7d1(0xfe)]('/delete-account',authorise_1[a7_0x5dc7d1(0x112)],(_0x334376,_0x264213)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x57f800=a7_0x5dc7d1;try{const _0x59a426=_0x334376[_0x57f800(0x123)],_0x22932e=yield User_1[_0x57f800(0xf4)]['findByIdAndDelete'](_0x59a426);if(!_0x22932e){_0x264213['status'](0x194)[_0x57f800(0xe0)]({'message':_0x57f800(0xe6)});return;}console[_0x57f800(0xe9)](_0x57f800(0x11a)),yield Company_1['Company'][_0x57f800(0x129)]({'ownerID':_0x59a426}),console[_0x57f800(0xe9)](_0x57f800(0x117)),yield Product_1[_0x57f800(0xf1)][_0x57f800(0x129)]({'ownerID':_0x59a426}),_0x264213[_0x57f800(0xf9)](0xc8)[_0x57f800(0xe0)]({'message':_0x57f800(0x120)});}catch(_0x407d82){console[_0x57f800(0xe9)](_0x57f800(0x11c),_0x407d82),_0x264213[_0x57f800(0xf9)](0x1f4)[_0x57f800(0xe0)]({'message':'Internal\x20server\x20error','error':_0x407d82});}})),exports[a7_0x5dc7d1(0x112)]=router;