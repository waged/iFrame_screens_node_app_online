'use strict';function a2_0x44f7(){const _0x47e520=['split','5260GWHtXp','default','63iAzqtR','Token\x20missing\x20from\x20authorization\x20header','__esModule','../handlers/error_handler','JWT_SECRET','_id','verify','427tiSNZW','1974ZPgKjE','env','373476QIwTEG','ResponseHandler','token','jsonwebtoken','66370gCWcdl','57448qTDQEO','defineProperty','6004iysiUl','12URAFjd','authorization','Authorization\x20header\x20missing','310753pjghAl','__importDefault','email','unauthorized','userId','1011uOWQMH','5235043PeUjcm'];a2_0x44f7=function(){return _0x47e520;};return a2_0x44f7();}const a2_0x706ebd=a2_0x2be7;(function(_0x58b9f0,_0x523ffd){const _0x26fe80=a2_0x2be7,_0x3172be=_0x58b9f0();while(!![]){try{const _0x2c928f=parseInt(_0x26fe80(0x192))/0x1+parseInt(_0x26fe80(0x187))/0x2+-parseInt(_0x26fe80(0x197))/0x3*(parseInt(_0x26fe80(0x18e))/0x4)+parseInt(_0x26fe80(0x19a))/0x5*(parseInt(_0x26fe80(0x185))/0x6)+-parseInt(_0x26fe80(0x184))/0x7*(-parseInt(_0x26fe80(0x18c))/0x8)+parseInt(_0x26fe80(0x17d))/0x9*(parseInt(_0x26fe80(0x18b))/0xa)+-parseInt(_0x26fe80(0x198))/0xb*(parseInt(_0x26fe80(0x18f))/0xc);if(_0x2c928f===_0x523ffd)break;else _0x3172be['push'](_0x3172be['shift']());}catch(_0x21db3d){_0x3172be['push'](_0x3172be['shift']());}}}(a2_0x44f7,0x548ed));var __importDefault=this&&this[a2_0x706ebd(0x193)]||function(_0x5c57c5){const _0x243aa0=a2_0x706ebd;return _0x5c57c5&&_0x5c57c5[_0x243aa0(0x17f)]?_0x5c57c5:{'default':_0x5c57c5};};Object[a2_0x706ebd(0x18d)](exports,a2_0x706ebd(0x17f),{'value':!![]});const jsonwebtoken_1=__importDefault(require(a2_0x706ebd(0x18a))),error_handler_1=require(a2_0x706ebd(0x180)),authorise=(_0x475769,_0x248eb7,_0xd53f4)=>{const _0x129894=a2_0x706ebd;try{const _0x59cae3=_0x475769['headers'][_0x129894(0x190)];if(!_0x59cae3){error_handler_1[_0x129894(0x188)]['error'](_0x248eb7,_0x129894(0x191),0x191);return;}const _0x3efb86=_0x59cae3[_0x129894(0x199)]('\x20')[0x1];if(!_0x3efb86){error_handler_1[_0x129894(0x188)]['error'](_0x248eb7,_0x129894(0x17e),0x191);return;}const _0x49f4a1=jsonwebtoken_1[_0x129894(0x19b)][_0x129894(0x183)](_0x3efb86,process[_0x129894(0x186)][_0x129894(0x181)]);_0x475769[_0x129894(0x196)]=_0x49f4a1[_0x129894(0x182)],_0x475769['email']=_0x49f4a1[_0x129894(0x194)],_0x475769[_0x129894(0x189)]=_0x3efb86,_0xd53f4();}catch(_0x368c05){error_handler_1[_0x129894(0x188)][_0x129894(0x195)](_0x248eb7,'Invalid\x20or\x20expired\x20token');return;}};function a2_0x2be7(_0x45be82,_0x4e2ec8){const _0x44f793=a2_0x44f7();return a2_0x2be7=function(_0x2be746,_0x1d8364){_0x2be746=_0x2be746-0x17d;let _0x438534=_0x44f793[_0x2be746];return _0x438534;},a2_0x2be7(_0x45be82,_0x4e2ec8);}exports['default']=authorise;